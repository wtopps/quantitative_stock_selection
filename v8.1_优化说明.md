# A股次日冲高标的筛选系统 v8.1 优化说明

## 版本信息
- **版本号**: v8.1 - 精准剪枝版
- **优化日期**: 2026-01-14
- **优化目标**: 减少选股数量 + 添加板块信息 + 排除创业板和科创板

---

## 一、剪枝优化内容

### 1. 收紧基础筛选条件

#### 1.1 涨幅区间筛选（第一步）
- **优化前**: -2% ≤ 涨幅 ≤ 7%
- **优化后**: **-1% ≤ 涨幅 ≤ 5.5%**
- **优化理由**: 收紧区间，聚焦更稳健的标的，过滤掉回调过大和涨幅过猛的股票

#### 1.1.5 板块限制筛选（第一步新增）⭐
- **新增限制**: 仅保留**沪深主板**股票
- **排除板块**:
  - ❌ **创业板**: 股票代码以 "3" 开头（300xxx, 301xxx等）
  - ❌ **科创板**: 股票代码以 "688" 开头（688xxx）
  - ❌ **北交所**: 股票代码以 "8" 或 "4" 开头
- **保留板块**:
  - ✅ **沪市主板**: 股票代码以 "600", "601", "603" 等开头
  - ✅ **深市主板**: 股票代码以 "000", "001" 等开头
- **优化理由**:
  - 创业板和科创板波动较大，风险较高
  - 主板股票相对稳健，更符合次日冲高的稳健策略
  - 减少标的数量，聚焦主板优质股

#### 1.2 量比筛选（第二步）
- **优化前**: 量比 ≥ 1
- **优化后**: **量比 ≥ 1.2**
- **优化理由**: 提高量比要求，过滤成交清淡的标的，确保有足够的资金关注度

#### 1.3 换手率筛选（第三步）
- **优化前**: 8% ≤ 换手率 ≤ 20%
- **优化后**: **10% ≤ 换手率 ≤ 18%**
- **优化理由**: 收紧区间，聚焦活跃但不过热的标的，避免换手率过高的炒作股

#### 1.4 流通市值筛选（第四步）
- **优化前**: 30亿 ≤ 流通市值 ≤ 150亿
- **优化后**: **40亿 ≤ 流通市值 ≤ 120亿**
- **优化理由**: 收紧市值区间，兼顾流动性和稳定性

---

### 2. 增加综合评分和风险收益比筛选（第十一步）

#### 2.1 综合评分阈值筛选
- **新增要求**: **综合评分 ≥ 55**
- **筛选位置**: 三维度综合分析完成后
- **优化理由**: 只保留综合评分达到良好水平的股票，对应A级及以上评级

#### 2.2 风险收益比筛选
- **新增要求**: **风险收益比 ≥ 1.5**
- **筛选位置**: 三维度综合分析完成后
- **优化理由**: 确保潜在收益至少是潜在风险的1.5倍，提高风险收益比

#### 2.3 双重筛选逻辑
```python
# v8.1新增：剪枝逻辑 - 只保留综合评分≥55且风险收益比≥1.5的股票
if composite_score >= 55 and risk_reward >= 1.5:
    qualified_stocks.append(row_copy)
```

---

### 3. 最终数量限制

#### 3.1 Top 20限制
- **新增限制**: 最多输出综合评分最高的前20只
- **实施方式**: 按综合评分排序后取前20名
- **优化理由**: 即使通过所有筛选，也只保留最优质的标的，避免分散精力

#### 3.2 统计信息优化
```
✅ 多维度分析完成: 20 只 (已过滤: 综合评分≥55 & 风险收益比≥1.5)
🎯 v8.1剪枝: 从35只筛选出综合评分最高的前20只
```

---

## 二、新增板块信息显示

### 1. 板块信息获取
- **获取位置**: 三维度综合分析时（step11）
- **获取方法**: 调用 `get_stock_concepts(stock_code)` 获取股票所属行业
- **存储字段**: 新增 `所属板块` 字段

### 2. 板块信息展示
```python
# 在个股详情中显示板块信息
print(f"     🏢 所属板块: {sector}")
```

### 3. 展示效果示例
```
  🔥 000001 | 平安银行 | 💰当前价: 12.50元 🔥连续2天 👑超级龙头
     🏆 综合评级: AAA(极强) | 评分: 78.5
     🏢 所属板块: 银行
     📊 涨幅: 3.20% | 量比: 1.85 | 换手率: 12.50% | 流通市值: 85.2亿
     ...
```

---

## 三、优化效果预期

### 1. 数量控制
- **预期效果**: 选股数量从原来的30-50只减少到**最多20只**
- **板块限制**: 排除创业板和科创板后，标的池进一步缩小
- **质量提升**: 只保留综合评分和风险收益比双优的沪深主板标的

### 2. 筛选更精准
- **基础筛选**: 通过收紧条件，在早期就过滤掉不符合要求的股票
- **综合筛选**: 通过综合评分和风险收益比双重把关，确保标的质量
- **数量限制**: 即使通过所有筛选，也只保留Top 20

### 3. 信息更全面
- **板块信息**: 帮助用户了解股票所属行业，便于分散投资或集中布局
- **决策支持**: 可以根据板块热度和行业趋势做出更明智的选择

---

## 四、使用建议

### 1. 优先级建议
1. **首选**: AAA级标的（三维共振）
2. **次选**: AA级标的（强势标的）
3. **备选**: A级标的（良好标的）

### 2. 风险收益比参考
- **风险收益比 ≥ 3**: 优秀，可重点关注
- **风险收益比 ≥ 2**: 良好，值得配置
- **风险收益比 ≥ 1.5**: 一般，谨慎操作

### 3. 板块分散建议
- 建议不要将资金集中在单一板块
- 可以根据 `所属板块` 信息进行板块分散
- 关注板块轮动机会

---

## 五、技术细节

### 1. 核心代码位置
- **筛选条件收紧**: scan_stock_v8.py:1823-2003 行
- **综合评分筛选**: scan_stock_v8.py:2590-2592 行
- **数量限制**: scan_stock_v8.py:2600-2604 行
- **板块信息获取**: scan_stock_v8.py:2548-2555 行
- **板块信息显示**: scan_stock_v8.py:2934-2939 行

### 2. 参数调整记录
| 参数 | v8.0 | v8.1 | 变化 |
|------|------|------|------|
| 涨幅区间 | -2%~7% | -1%~5.5% | 收紧 |
| 量比 | ≥1 | ≥1.2 | 提高 |
| 换手率 | 8%~20% | 10%~18% | 收紧 |
| 流通市值 | 30~150亿 | 40~120亿 | 收紧 |
| 板块限制 | 无 | **仅沪深主板** | **新增** |
| 创业板 | ✅ | **❌ 排除** | **新增** |
| 科创板 | ✅ | **❌ 排除** | **新增** |
| 北交所 | ❌ | ❌ 排除 | 保持 |
| 综合评分 | 无限制 | ≥55 | 新增 |
| 风险收益比 | 无限制 | ≥1.5 | 新增 |
| 最大数量 | 无限制 | 20只 | 新增 |

---

## 六、注意事项

### 1. 参数可调整性
如果您觉得20只还是太多或太少，可以修改以下参数：
- **综合评分阈值**: scan_stock_v8.py:2591行，修改 `55` 为其他值（如60、50）
- **风险收益比阈值**: scan_stock_v8.py:2591行，修改 `1.5` 为其他值（如2.0、1.2）
- **最大数量限制**: scan_stock_v8.py:2602行，修改 `20` 为其他值（如10、30）

### 2. 空仓策略
- 如果筛选结果为0只，说明当前市场没有符合条件的高质量标的
- 建议遵循"无标的满足则当日放弃，不强行开仓"的原则
- 空仓也是一种策略

### 3. 市场情绪
- v8.1保留了市场情绪检查功能
- 当市场情绪极度低迷时（评分<30），即使有标的也建议谨慎
- 降低仓位或空仓观望

---

## 七、版本对比总结

| 特性 | v8.0 | v8.1 |
|------|------|------|
| 涨幅区间 | -2%~7% | -1%~5.5% |
| 量比要求 | ≥1 | ≥1.2 |
| 换手率 | 8%~20% | 10%~18% |
| 市值区间 | 30~150亿 | 40~120亿 |
| **板块限制** | **无** | **仅沪深主板** ⭐ |
| **创业板** | **✅ 包含** | **❌ 排除** ⭐ |
| **科创板** | **✅ 包含** | **❌ 排除** ⭐ |
| 综合评分筛选 | ❌ | ✅ ≥55 |
| 风险收益比筛选 | ❌ | ✅ ≥1.5 |
| 数量限制 | ❌ | ✅ Top 20 |
| 板块信息显示 | ❌ | ✅ |
| 预期选股数量 | 30-50只 | ≤20只 |
| 标的稳健性 | 中等 | 高 |

---

## 八、更新日志

### v8.1 (2026-01-14) - 精准剪枝版
- ✅ 收紧涨幅区间至 -1%~5.5%
- ✅ 提高量比要求至 ≥1.2
- ✅ 收紧换手率至 10%~18%
- ✅ 收紧市值区间至 40~120亿
- ✅ **新增板块限制：仅保留沪深主板**
- ✅ **排除创业板股票（3开头）**
- ✅ **排除科创板股票（688开头）**
- ✅ 新增综合评分≥55筛选
- ✅ 新增风险收益比≥1.5筛选
- ✅ 新增Top 20数量限制
- ✅ 新增板块信息显示
- ✅ 优化输出统计信息
- ✅ 更新版本说明和文档

---

## 九、为什么要排除创业板和科创板？

### 1. 波动性考虑
- **创业板**: 20%涨跌幅限制，日内波动剧烈，风险较高
- **科创板**: 同样20%涨跌幅限制，且个股波动更大
- **主板**: 10%涨跌幅限制，波动相对可控

### 2. 稳健策略匹配
- 本脚本策略定位为"次日冲高"，追求稳健收益
- 主板股票更符合这一定位，风险收益比更合理
- 创业板和科创板更适合激进策略

### 3. 流动性和规模
- 主板股票普遍市值更大，流动性更好
- 本脚本已限定市值在40-120亿，更适合主板标的
- 创业板和科创板小市值股票易受操纵

### 4. 实际效果
- 排除后标的数量进一步精简
- 聚焦主板优质股，提高整体稳健性
- 降低因波动过大导致的风险

---

**优化完成！现在您可以运行脚本，选股数量将显著减少，只保留沪深主板的优质标的，并且会显示每只股票的所属板块信息。**
